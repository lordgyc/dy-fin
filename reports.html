<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DY Finance – Reports</title>
    <link rel="stylesheet" href="./report.css">
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
</head>
<body>

    <header class="header">
        <div class="container header-inner">
            <a class="logo" href="./index.html" aria-label="DY Finance Home">
                <img src="./assets/dy-finance-logo.svg" alt="DY Finance" />
            </a>
            <nav class="nav">
                <a id="back-to-login-btn" class="btn btn-ghost" href="./index.html">Back to Login</a>
                <a id="go-to-workspace-btn" class="btn btn-primary" href="./workspace.html">Go to Workspace</a>
                <div class="separator"></div>
                <div class="dropdown">
                    <button id="reports-dropdown-btn" class="btn dropdown-toggle">
                        Reports
                        <span class="dropdown-arrow">▼</span>
                    </button>
                    <div class="dropdown-menu">
                        <button class="dropdown-item" data-section="vat-report-section">VAT Report</button>
                        <button class="dropdown-item" data-section="jv-report-section">JV Report</button>
                        <button class="dropdown-item" data-section="summary-report-section">Summary Report</button>
                        <button class="dropdown-item" data-section="yearly-report-section">Yearly Report</button>
                    </div>
                </div>
                <button id="management-button" class="btn" data-section="management-section">Management</button>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Default Welcome Message -->
        <section id="reports-page-default-message" class="welcome-card">
            <h1>Reports & Management</h1>
            <p class="card-desc">Select a report from the header to view data or manage application settings.</p>
        </section>

        <!-- VAT Report Section -->
        <section id="vat-report-section" class="page-section" style="display: none;">
            <div class="page-header">
                <h1>VAT Report</h1>
                <div class="controls">
                    <select id="ethiopian-month-select" class="input" title="Ethiopian Month">
                        <option value="1">Meskerem</option>
                        <option value="2">Tekemt</option>
                        <option value="3">Hidar</option>
                        <option value="4">Tahsas</option>
                        <option value="5">Tir</option>
                        <option value="6">Yekatit</option>
                        <option value="7">Megabit</option>
                        <option value="8">Miyazya</option>
                        <option value="9">Ginbot</option>
                        <option value="10">Sene</option>
                        <option value="11">Hamle</option>
                        <option value="12">Nehase</option>
                        <option value="13">Paguemen</option>
                    </select>
                    <input type="number" id="ethiopian-year-input" class="input" title="Ethiopian Year" placeholder="Enter Year (E.C.)">
                    <button id="generate-vat-report-btn" class="btn">Generate</button>
                    <button id="export-vat-report-btn" class="btn btn-primary">Export to Excel</button>
                </div>
            </div>
            <div class="card">
                <div class="table-wrapper">
                    <table class="table" id="vat-report-table">
                        <thead>
                            <tr><th>TIN No</th><th>Vendor Name</th><th>Purchase Date</th><th>MRC No</th><th>FS Number</th><th>Item Name</th><th class="is-numeric">Quantity</th><th class="is-numeric">Unit Price</th><th class="is-numeric">Base Total</th><th class="is-numeric">VAT Amount</th><th class="is-numeric">Total Amount</th></tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="11" class="placeholder-cell">Generate a report to see data.</td></tr>
                        </tbody>
                        <tfoot>
                            <tr><td colspan="8"><strong>Total Summary</strong></td><td id="summary-base-total" class="is-numeric">0.00</td><td id="summary-vat-amount" class="is-numeric">0.00</td><td id="summary-total-amount" class="is-numeric"><strong>0.00</strong></td></tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </section>

        <!-- JV Report Section -->
        <section id="jv-report-section" class="page-section" style="display: none;">
            <div class="page-header">
                <h1>JV Report</h1>
                <div class="controls">
                    <input type="date" id="single-date" class="input" title="Select Date">
                    <button id="generate-jv-report-btn" class="btn btn-primary">Generate</button>
                    <button id="generate-jv-pdf-btn" class="btn btn-primary">Generate PDF</button>

                </div>
            </div>
            <div class="card">
                <div class="table-wrapper">
            <table class="table" id="jv-report-table">
                        <thead>
                            <tr>
                                <th rowspan="2">Items</th>
                                <th colspan="2" class="is-numeric">Debt</th>
                                <th colspan="2" class="is-numeric">Credit</th>
                            </tr>
                            <tr>
                                <th class="is-numeric">Birr</th>
                                <th class="is-numeric">Cents</th>
                                <th class="is-numeric">Birr</th>
                                <th class="is-numeric">Cents</th>
                            </tr>
                        </thead>
                        <tbody><tr><td colspan="5" class="placeholder-cell">Generate a report to see data.</td></tr></tbody>
                        <tfoot></tfoot>
                    </table>
                </div>
            </div>
        </section>

        <!-- Summary Report Section -->
         
        <!-- Summary Report Section -->
             <section id="summary-report-section" class="page-section" style="display: none;">
            <div class="page-header">
                <h1>Summary Report</h1>
                <div class="controls">
                    <select id="summary-ethiopian-month-select" class="input" title="Ethiopian Month">
                        <option value="1">Meskerem</option>
                        <option value="2">Tekemt</option>
                        <option value="3">Hidar</option>
                        <option value="4">Tahsas</option>
                        <option value="5">Tir</option>
                        <option value="6">Yekatit</option>
                        <option value="7">Megabit</option>
                        <option value="8">Miyazya</option>
                        <option value="9">Ginbot</option>
                        <option value="10">Sene</option>
                        <option value="11">Hamle</option>
                        <option value="12">Nehase</option>
                        <option value="13">Paguemen</option>
                    </select>
                    <input type="number" id="summary-ethiopian-year-input" class="input" title="Ethiopian Year" placeholder="Enter Year (E.C.)">
                    <button id="generate-summary-report-btn" class="btn btn-primary">Generate</button>
                    <button id="generate-summary-pdf-btn" class="btn btn-primary">Generate PDF</button>

                </div>
            </div>
            <div class="card">
                <!-- The table wrapper's existing CSS will automatically handle scrolling -->
                <div class="table-wrapper">
                    <table class="table" id="summary-report-table">
                        <thead>
                            <tr><th>Date</th></tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="1" class="placeholder-cell">Generate a report to see data.</td></tr>
                        </tbody>
                    </table>
                </div>
                <!-- PAGINATION CONTROLS REMOVED FROM HERE -->
            </div>
        </section>

        <!-- Yearly Report Section -->
        <section id="yearly-report-section" class="page-section" style="display: none;">
            <div class="page-header">
                <h1>Yearly Report</h1>
                <div class="controls">
                    <select id="yearly-subcategory-select" class="input" title="Select Subcategory">
                        <option value="">Select Subcategory</option>
                    </select>
                    <input type="number" id="yearly-ethiopian-year-input" class="input" title="Enter Ethiopian Year" placeholder="Enter Year (E.C.)">
                    <button id="generate-yearly-report-btn" class="btn btn-primary">Generate</button>
                    <button id="export-yearly-report-btn" class="btn btn-primary">Export to Excel</button>
                </div>
            </div>
            <div class="card">
                <div class="table-wrapper">
                    <table class="table" id="yearly-report-table">
                        <thead>
                            <tr>
                                <th>Vendor Name</th>
                                <th>TIN No</th>
                                <th>MRC No</th>
                                <th>Purchase Date</th>
                                <th>FS Number</th>
                                <th>Item Name</th>
                                <th class="is-numeric">Quantity</th>
                                <th class="is-numeric">Unit Price</th>
                                <th class="is-numeric">VAT Amount</th>
                                <th class="is-numeric">Base Total</th>
                                <th class="is-numeric">Total Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="13" class="placeholder-cell">Select a subcategory and year to generate report.</td></tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="8"><strong>Total Summary</strong></td>
                                <td id="yearly-summary-vat-amount" class="is-numeric">0.00</td>
                                <td id="yearly-summary-base-total" class="is-numeric">0.00</td>
                                <td id="yearly-summary-total-amount" class="is-numeric"><strong>0.00</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </section>

        <!-- Management Section -->
        <section id="management-section" class="page-section" style="display: none;">
            <div class="page-header"><h1>Management</h1></div>
            <div class="card">
                <div class="tabs">
                    <button class="tab-button active" data-tab="vendor-tab">Vendors</button>
                    <button class="tab-button" data-tab="items-tab">Items & Categories</button>
                    <button class="tab-button" data-tab="backup-tab">Backup</button>
                </div>
                <div class="card-body">
                    <div id="vendor-tab" class="tab-content active">
                        <div class="content-header">
                            <h3>Manage Vendors</h3>
                            <button id="openModalBtn" data-action="add-vendor" class="btn btn-primary">Add Vendor</button>
                        </div>
                        <div class="table-wrapper">
                            <table id="vendors-table" class="table">
                               <thead><tr><th>Vendor Name</th><th>TIN Number</th><th>MRC Numbers</th><th>Actions</th></tr></thead>
                               <tbody><td colspan="4" class="placeholder-cell">Loading vendors...</td></tbody>
                            </table>
                        </div>
                    </div>
                    <div id="items-tab" class="tab-content">
                        <div class="content-header">
                            <h3>Manage Categories</h3>
                            <div class="controls">
                                <button id="openAddCategoryModalBtn" class="btn">Add New Category</button>
                                <button id="editCategoryBtn" class="btn">Edit Selected</button>
                                <button id="deleteCategoryBtn" class="btn btn-ghost">Delete Selected</button>
                            </div>
                        </div>

                        <div class="content-header" style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border);">
                            <h3>Manage Items</h3>
                            <div class="controls">
                                <button id="openAddSubcategoryModalBtn" class="btn">Add Subcategory</button>
                                <button id="editSubcategoryBtn" class="btn">Edit Selected Subcategory</button>
                                <button id="deleteSubcategoryBtn" class="btn btn-ghost">Delete Selected Subcategory</button>
                            </div>
                        </div>

                        <div class="controls" style="margin-bottom: 1.5rem;">
                            <select id="itemCategorySelect" class="input" title="Filter by Category or Select for Action"></select>
                            <select id="itemSubcategorySelect" class="input" title="Filter by Subcategory or Select for Action"></select>
                        </div>

                        <div class="controls" style="margin-bottom: 1.5rem;">
                            <input type="text" id="newItemName" placeholder="New Item Name" class="input" style="flex-grow: 2;">
                            <input type="number" id="newItemUnitPrice" placeholder="Unit Price" class="input" style="flex-grow: 1;">
                            <input type="text" id="newItemDescription" placeholder="Description" class="input" style="flex-grow: 2;">
                            <button id="addItemBtn" class="btn btn-primary">Add Item</button>
                        </div>

                        <div class="table-wrapper">
                             <table id="items-table" class="table">
                               <thead><tr><th>Item Name</th><th>Category</th><th>Subcategory</th><th class="is-numeric">Unit Price</th><th>Description</th><th>Actions</th></tr></thead>
                               <tbody><tr><td colspan="6" class="placeholder-cell">Select a category to see items.</td></tr></tbody>
                            </table>
                        </div>
                    </div>
                    <div id="backup-tab" class="tab-content">
                        <div class="content-header">
                            <h3>Database Backup</h3>
                        </div>
                        <div class="form-group">
                            <label for="backupPathInput">Backup Directory Path:</label>
                            <input type="text" id="backupPathInput" class="input" placeholder="e.g., C:\Users\HP\Documents\Backups" />
                            <button id="browseBackupPathBtn" class="btn">Browse</button>
                        </div>
                        <button id="performBackupBtn" class="btn btn-primary" style="margin-top: 1rem;">Perform Backup</button>
                        <p id="backupStatusMessage" style="margin-top: 1rem;"></p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- MODALS -->
    <div id="addVendorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="vendorModalTitle">Add New Vendor</h2>
                <button class="close-btn">&times;</button>
            </div>
            <form id="addVendorForm" class="modal-body">
                <input type="hidden" id="vendorId" name="vendorId">
                <div class="form-group">
                    <label for="vendorName">Vendor Name</label>
                    <input type="text" id="vendorName" name="vendorName" class="input" required />
                </div>
                <div class="form-group">
                    <label for="tinNumber">TIN Number</label>
                    <input type="text" id="tinNumber" name="tinNumber" class="input" required />
                </div>
                <div class="form-group">
                    <label>MRC Numbers</label>
                    <div id="mrcContainer">
                         <div class="mrc-input-group">
                            <input type="text" name="mrcNumbers[]" class="input"/>
                         </div>
                    </div>
                    <button type="button" id="addMrcBtn" class="btn" style="margin-top: 0.5rem;">Add MRC Field</button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn close-btn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Vendor</button>
                </div>
            </form>
        </div>
    </div>

    <div id="addCategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="categoryModalTitle">Add Category</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newCategoryNameModal">Category Name</label>
                    <input type="text" id="newCategoryNameModal" placeholder="New Category Name" class="input">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn close-btn">Cancel</button>
                <button id="addCategoryBtnModal" class="btn btn-primary">Add Category</button>
            </div>
        </div>
    </div>

    <div id="addSubcategoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="subcategoryModalTitle">Add Subcategory</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="subcategoryCategorySelectModal">Parent Category</label>
                    <select id="subcategoryCategorySelectModal" class="input"></select>
                </div>
                <div class="form-group">
                    <label for="newSubcategoryNameModal">Subcategory Name</label>
                    <input type="text" id="newSubcategoryNameModal" placeholder="New Subcategory Name" class="input">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn close-btn">Cancel</button>
                <button id="addSubcategoryBtnModal" class="btn btn-primary">Add Subcategory</button>
            </div>
        </div>
    </div>

    <div id="customNotificationModal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
             <div class="modal-header">
                <h2>Notification</h2>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p id="notificationMessage" style="font-size: 1rem;"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary close-btn">OK</button>
            </div>
        </div>
    </div>

    <script src="./reports.js"></script>
</body>
</html>
